{"version": 1,"name": "particles-default-update.cgfx","samplers":{"previousState":{"MinFilter": 9728,"MagFilter": 9728,"WrapS": 33071,"WrapT": 33071},"creationState":{"MinFilter": 9728,"MagFilter": 9728,"WrapS": 33071,"WrapT": 33071},"mappingTable":{"MinFilter": 9728,"MagFilter": 9728,"WrapS": 33071,"WrapT": 33071},"vParticleState":{"MinFilter": 9728,"MagFilter": 9728,"WrapS": 33071,"WrapT": 33071},"fParticleState":{"MinFilter": 9728,"MagFilter": 9728,"WrapS": 33071,"WrapT": 33071},"animation":{"MinFilter": 9728,"MagFilter": 9728,"WrapS": 33071,"WrapT": 33071},"noiseTexture":{"MinFilter": 9985,"MagFilter": 9729,"WrapS": 10497,"WrapT": 10497}},"parameters":{"textureSize":{"type": "float","columns": 2},"invTextureSize":{"type": "float","columns": 2},"regionSize":{"type": "float","columns": 2},"invRegionSize":{"type": "float","columns": 2},"regionPos":{"type": "float","columns": 2},"halfExtents":{"type": "float","columns": 3},"center":{"type": "float","columns": 3},"maxLifeTime":{"type": "float"},"previousState":{"type": "sampler2D"},"shift":{"type": "float","columns": 3},"timeStep":{"type": "float"},"lifeStep":{"type": "float"},"maxSpeed":{"type": "float"},"creationState":{"type": "sampler2D"},"creationScale":{"type": "float","columns": 2},"projection":{"type": "float","rows": 4,"columns": 4},"modelView":{"type": "float","rows": 4,"columns": 3},"mappingTable":{"type": "sampler2D"},"mappingSize":{"type": "float","columns": 2},"invMappingSize":{"type": "float","columns": 2},"mappingPos":{"type": "float","columns": 2},"vParticleState":{"type": "sampler2D"},"fParticleState":{"type": "sampler2D"},"animationSize":{"type": "float","columns": 2},"animation":{"type": "sampler2D"},"zSorted":{"type": "bool"},"acceleration":{"type": "float","columns": 3},"drag":{"type": "float"},"noiseTexture":{"type": "sampler2D"},"randomizedAcceleration":{"type": "float","columns": 3}},"techniques":{"update":[{"parameters": ["invTextureSize","regionSize","regionPos","invTextureSize","regionSize","invRegionSize","regionPos","halfExtents","previousState","shift","timeStep","lifeStep","maxSpeed","creationState","creationScale","acceleration","drag","noiseTexture","randomizedAcceleration"],"semantics": ["ATTR0"],"states":{"DepthTestEnable": false,"DepthMask": false,"CullFaceEnable": false,"BlendEnable": false},"programs": ["vp_update","fp_update_state"]}]},"programs":{"fp_update_state":{"type": "fragment","code": "#ifdef GL_ES\n#define TZ_LOWP lowp\nprecision mediump float;\nprecision mediump int;\n#else\n#define TZ_LOWP\n#endif\nvarying vec4 tz_TexCoord[1];\nvec4 _ret_0;vec2 _TMP18;vec2 _TMP33;float _TMP38;float _TMP31;vec2 _TMP16;vec4 _TMP37;float _TMP15;vec3 _TMP14;vec4 _TMP30;vec2 _TMP13;vec2 _TMP11;vec2 _TMP12;vec2 _TMP25;vec2 _TMP24;vec2 _TMP10;vec4 _TMP9;float _TMP35;vec2 _TMP8;vec4 _TMP7;vec2 _TMP6;vec4 _TMP5;vec2 _TMP4;vec2 _TMP34;vec2 _TMP3;vec2 _TMP1;float _TMP20;vec4 _TMP19;vec2 _TMP0;vec2 _x0072;vec2 _c0074;vec2 _c0078;vec4 _life0084;vec2 _c0086;float _TMP93;vec2 _TMP103;vec2 _x0108;float _TMP121;float _TMP139;float _x0146;vec4 _TMP147;float _x0148;vec4 _enc10148;float _TMP151;vec4 _x0158;float _TMP171;vec4 _TMP179;vec2 _c0182;vec2 _TMP183;vec2 _enc10184;float _TMP187;vec2 _x0194;vec4 _life0202;vec2 _c0204;float _TMP211;float _TMP223;vec4 _c010230;vec2 _c0232;float _TMP239;float _TMP251;vec2 _c0260;float _TMP263;float _x0264;float _b0268;float _x0270;vec4 _TMP271;float _x0272;vec4 _enc10272;float _TMP275;vec4 _x0282;float _TMP293;vec2 _TMP299;float _x0300;vec2 _enc10300;float _TMP303;vec2 _x0310;float _TMP315;bvec2 _bvec10316;int _i0316;bool _TMP317;float _TMP318;bvec2 _bvec10319;int _i0319;bool _TMP320;float _TMP321;bvec2 _bvec10322;int _i0322;bool _TMP323;float _TMP324;bvec2 _bvec10325;int _i0325;bool _TMP326;uniform vec2 invTextureSize;uniform vec2 regionSize;uniform vec2 invRegionSize;uniform vec2 regionPos;uniform vec3 halfExtents;uniform sampler2D previousState;uniform vec3 shift;uniform float timeStep;uniform float lifeStep;uniform float maxSpeed;uniform sampler2D creationState;uniform vec2 creationScale;uniform vec3 acceleration;uniform float drag;uniform sampler2D noiseTexture;uniform vec3 randomizedAcceleration;void main()\n{vec2 _particle5;vec2 _index;vec2 _pIndex;float _p1;vec2 _vt1;float _v1;float _v2;float _a1;float _animTime1;float _d1;vec4 _pix11;_particle5=tz_TexCoord[0].xy*regionSize;_x0072=_particle5/vec2(3.0,3.0);_TMP0=floor(_x0072);_index=_TMP0*vec2(3.0,3.0);_c0078=(_index+vec2(2.5,0.5))*invRegionSize*creationScale;_TMP19=texture2D(creationState,_c0078);_TMP20=dot(_TMP19.xy,_TMP19.xy);if(_TMP20>0.0){_c0074=tz_TexCoord[0].xy*creationScale;_ret_0=texture2D(creationState,_c0074);gl_FragColor=_ret_0;return;}\n_pIndex=_index*invRegionSize;_TMP1=(regionPos+regionSize*_pIndex)*invTextureSize;_c0086=_TMP1+vec2(2.5,0.5)*invTextureSize;_life0084=texture2D(previousState,_c0086);_TMP31=dot(_life0084.zw,vec2(3.89099121E-003,9.96093750E-001));_TMP38=min(1.0,_TMP31);_TMP93=max(0.0,_TMP38);if(_TMP93<=0.0){_TMP3=(regionPos+regionSize*tz_TexCoord[0].xy)*invTextureSize;_ret_0=texture2D(previousState,_TMP3);gl_FragColor=_ret_0;return;}\n_x0108=_particle5/vec2(3.0,3.0);_TMP34=floor(_x0108);_TMP103=_particle5-vec2(3.0,3.0)*_TMP34;if(_TMP103.x<=1.0){_TMP4=(regionPos+regionSize*tz_TexCoord[0].xy)*invTextureSize;_TMP5=texture2D(previousState,_TMP4);_TMP35=dot(_TMP5,vec4(5.93718141E-008,1.51991844E-005,3.89099121E-003,9.96093750E-001));_TMP38=min(1.0,_TMP35);_TMP121=max(0.0,_TMP38);_p1=(_TMP121-0.5)*2.0;_vt1=tz_TexCoord[0].xy+vec2(invRegionSize.x,0.0);_TMP6=(regionPos+regionSize*_vt1)*invTextureSize;_TMP7=texture2D(previousState,_TMP6);_TMP35=dot(_TMP7,vec4(5.93718141E-008,1.51991844E-005,3.89099121E-003,9.96093750E-001));_TMP38=min(1.0,_TMP35);_TMP139=max(0.0,_TMP38);_v1=(_TMP139-0.5)*2.0;_i0316=int(_TMP103.y);_TMP317=true;_bvec10316=bvec2(_i0316==0,_i0316==1);if(_bvec10316.x){_TMP315=halfExtents.x;_TMP317=false;}\nif(_TMP317){if(_bvec10316.y){_TMP315=halfExtents.y;_TMP317=false;}\nif(_TMP317){_TMP315=halfExtents.z;}}\n_i0319=int(_TMP103.y);_TMP320=true;_bvec10319=bvec2(_i0319==0,_i0319==1);if(_bvec10319.x){_TMP318=shift.x;_TMP320=false;}\nif(_TMP320){if(_bvec10319.y){_TMP318=shift.y;_TMP320=false;}\nif(_TMP320){_TMP318=shift.z;}}\n_x0146=_p1+(_v1*timeStep*maxSpeed)/_TMP315+_TMP318;_x0148=_x0146*0.5+0.5;if(_x0148>=1.0){_TMP147=vec4(1.0,1.0,1.0,1.0);}else{_TMP38=min(1.0,_x0148);_TMP151=max(0.0,_TMP38);_x0158=_TMP151*vec4(1.67772160E+007,6.55360000E+004,256.0,1.0);_TMP37=fract(_x0158);_enc10148=_TMP37*256.0;_enc10148.yzw=_enc10148.yzw-_enc10148.xyz/256.0;_TMP147=_enc10148/255.0;}\ngl_FragColor=_TMP147;return;}else{if(_TMP103.x<=2.0){_TMP8=(regionPos+regionSize*tz_TexCoord[0].xy)*invTextureSize;_TMP9=texture2D(previousState,_TMP8);_TMP35=dot(_TMP9,vec4(5.93718141E-008,1.51991844E-005,3.89099121E-003,9.96093750E-001));_TMP38=min(1.0,_TMP35);_TMP171=max(0.0,_TMP38);_v2=(_TMP171-0.5)*2.0;_i0322=int(_TMP103.y);_TMP323=true;_bvec10322=bvec2(_i0322==0,_i0322==1);if(_bvec10322.x){_TMP321=acceleration.x;_TMP323=false;}\nif(_TMP323){if(_bvec10322.y){_TMP321=acceleration.y;_TMP323=false;}\nif(_TMP323){_TMP321=acceleration.z;}}\n_a1=_TMP321;_TMP10=(regionPos+regionSize*_pIndex)*invTextureSize;_c0182=_TMP10+vec2(2.5,2.5)*invTextureSize;_TMP179=texture2D(previousState,_c0182);_x0264=_TMP179.w*1.27500000E+002;_TMP263=fract(_x0264);if(_TMP263>=0.5){if(_TMP179.z>=1.0){_TMP183=vec2(1.0,1.0);}else{_TMP38=min(1.0,_TMP179.z);_TMP187=max(0.0,_TMP38);_x0194=_TMP187*vec2(16.0,1.0);_TMP24=fract(_x0194);_enc10184=_TMP24*16.0;_enc10184.y=_enc10184.y-_enc10184.x/16.0;_TMP25=floor(_enc10184);_TMP183=_TMP25/15.0;}\n_TMP11=(regionPos+regionSize*_pIndex)*invTextureSize;_TMP12=(regionPos+regionSize*_pIndex)*invTextureSize;_c0204=_TMP12+vec2(2.5,0.5)*invTextureSize;_life0202=texture2D(previousState,_c0204);_TMP31=dot(_life0202.zw,vec2(3.89099121E-003,9.96093750E-001));_TMP38=min(1.0,_TMP31);_TMP211=max(0.0,_TMP38);_TMP31=dot(_life0202.xy,vec2(3.89099121E-003,9.96093750E-001));_TMP38=min(1.0,_TMP31);_TMP223=max(0.0,_TMP38);_TMP13=vec2(_TMP211,_TMP223);_c0232=_TMP11+vec2(2.5,1.5)*invTextureSize;_c010230=texture2D(previousState,_c0232);_TMP31=dot(_c010230.xy,vec2(3.89099121E-003,9.96093750E-001));_TMP38=min(1.0,_TMP31);_TMP239=max(0.0,_TMP38);_TMP31=dot(_c010230.zw,vec2(3.89099121E-003,9.96093750E-001));_TMP38=min(1.0,_TMP31);_TMP251=max(0.0,_TMP38);_animTime1=_TMP239-(_TMP13.x/_TMP13.y)*_TMP251;_c0260=_TMP183+vec2(9.73030090E-001,1.98425338E-001)*_animTime1+vec2(8.42003465E-001,5.96380889E-001);_TMP30=texture2D(noiseTexture,_c0260);_TMP14=(2.0*_TMP30.zyx-1.0)*randomizedAcceleration;_i0325=int(_TMP103.y);_TMP326=true;_bvec10325=bvec2(_i0325==0,_i0325==1);if(_bvec10325.x){_TMP324=_TMP14.x;_TMP326=false;}\nif(_TMP326){if(_bvec10325.y){_TMP324=_TMP14.y;_TMP326=false;}\nif(_TMP326){_TMP324=_TMP14.z;}}\n_a1=_TMP321+_TMP324;}\n_b0268=timeStep*drag;_TMP15=min(1.0,_b0268);_d1=1.0-_TMP15;_x0270=_d1*(_v2+(_a1*timeStep)/maxSpeed);_x0272=_x0270*0.5+0.5;if(_x0272>=1.0){_TMP271=vec4(1.0,1.0,1.0,1.0);}else{_TMP38=min(1.0,_x0272);_TMP275=max(0.0,_TMP38);_x0282=_TMP275*vec4(1.67772160E+007,6.55360000E+004,256.0,1.0);_TMP37=fract(_x0282);_enc10272=_TMP37*256.0;_enc10272.yzw=_enc10272.yzw-_enc10272.xyz/256.0;_TMP271=_enc10272/255.0;}\ngl_FragColor=_TMP271;return;}else{if(_TMP103.y<=1.0){_TMP16=(regionPos+regionSize*tz_TexCoord[0].xy)*invTextureSize;_pix11=texture2D(previousState,_TMP16);_TMP31=dot(_pix11.zw,vec2(3.89099121E-003,9.96093750E-001));_TMP38=min(1.0,_TMP31);_TMP293=max(0.0,_TMP38);_x0300=_TMP293-lifeStep;if(_x0300>=1.0){_TMP299=vec2(1.0,1.0);}else{_TMP38=min(1.0,_x0300);_TMP303=max(0.0,_TMP38);_x0310=_TMP303*vec2(256.0,1.0);_TMP33=fract(_x0310);_enc10300=_TMP33*256.0;_enc10300.y=_enc10300.y-_enc10300.x/256.0;_TMP299=_enc10300/255.0;}\n_ret_0=vec4(_pix11.x,_pix11.y,_TMP299.x,_TMP299.y);gl_FragColor=_ret_0;return;}else{_TMP18=(regionPos+regionSize*tz_TexCoord[0].xy)*invTextureSize;_ret_0=texture2D(previousState,_TMP18);gl_FragColor=_ret_0;return;}}}\ngl_FragColor=_ret_0;}"},"vp_update":{"type": "vertex","code": "#ifdef GL_ES\n#define TZ_LOWP lowp\nprecision mediump float;\nprecision mediump int;\n#else\n#define TZ_LOWP\n#endif\nvarying vec4 tz_TexCoord[1];attribute vec4 ATTR0;\nvec4 _outPosition1;vec2 _outParticle1;vec2 _TMP0;uniform vec2 invTextureSize;uniform vec2 regionSize;uniform vec2 regionPos;void main()\n{vec2 _TMP31;_TMP0=(regionPos+regionSize*ATTR0.xy)*invTextureSize;_TMP31=_TMP0*2.0-1.0;_outPosition1=vec4(_TMP31.x,_TMP31.y,0.0,1.0);_outParticle1=ATTR0.xy;tz_TexCoord[0].xy=ATTR0.xy;gl_Position=_outPosition1;}"}}}